# PostgreSQL Docker セットアップ

このプロジェクトではAlpine LinuxベースのPostgreSQLコンテナを使用しています。

## 前提条件

- Docker
- Docker Compose

## 使用方法

### 1. データ保存用ディレクトリの作成

```sh
mkdir -p ./pgdata
chmod 700 ./pgdata  # データディレクトリのパーミッションを制限
```

### 2. PostgreSQLコンテナの起動

```sh
docker-compose up -d
```

### 3. 動作確認

```sh
docker exec -it crud-postgres psql -U postgres -d crud_dev
```

### 4. コンテナの停止

```sh
docker-compose down
```

## 設定情報

- ユーザー名: postgres
- パスワード: postgres （**注意**: 本番環境では必ず変更してください)
- データベース名: crud_dev
- ポート: 127.0.0.1:5432 (ローカルホストからのみアクセス可能)
- データ保存ディレクトリ: ./pgdata

## セキュリティ対策

1. **認証方式**: SCRAM-SHA-256認証を使用
2. **ポート制限**: ローカルホスト(127.0.0.1)からのみアクセス可能
3. **コンテナ権限**: 必要最小限の権限のみを付与
4. **リソース制限**: メモリ使用量を512MBに制限

## 本番環境へ移行する際の推奨事項

1. 強力なパスワードを設定する
2. `.env`ファイルを使用して機密情報を管理する
3. ボリュームを適切にバックアップする
4. ネットワークセグメントを適切に分離する

## Elixirプロジェクトとの接続

このコンテナを起動することで、`config/dev.exs`で設定されているデータベース接続情報がそのまま使えます。変更不要です。 